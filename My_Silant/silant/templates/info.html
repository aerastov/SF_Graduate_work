{% extends 'default.html' %}
{% load auth_extras %}
{% block content %}


{% load static %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.1.1/css/tabulator.min.css" rel="stylesheet">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/4.1.1/js/tabulator.min.js"></script>
<script type="text/javascript" src="{% static 'js/tabulator.js' %}"></script>
<div style="display: none" id="jsonData" data-json="{{ cars_list }}"></div>



    <div class="div_full_horizontal_content_space_around">
        <a class="button_menu active" href="{% url 'info' %}" role="button">Машины</a>
        <a class="button_menu" href="{% url 'maintenance' %}" role="button">ТО</a>
        <a class="button_menu" href="{% url 'complaints' %}" role="button">Рекламации</a>
    </div>

    <h4 class="center">Информация о комплектации и технических<br>характеристиках вашей техники</h4>

    {% if request.user|has_group:"manager" or request.user|has_group:"admin" %}
        <div class="center">
            <a class="button slim" href="{% url 'create_car' %}" role="button">Добавить запись</a>
            <a class="button slim" href="{% url 'reference_book' %}" role="button">Редактор справочников</a>
        </div>
    {% endif %}

    {% if cars %}
        <table>
        <tr>
            <th><a href="?order_by=factory_number">№</a></th>
            <th><a href="?order_by=technique_model">модель техники</a></th>
            <th><a href="?order_by=engine_model">модель двигателя</a></th>
            <th><a href="?order_by=engine_number">№ двигателя</a></th>
            <th><a href="?order_by=transmission_model">модель трансмиссии</a></th>
            <th><a href="?order_by=transmission_number">№ трансмиссии</a></th>
            <th><a href="?order_by=drive_axle_model">модель ведущего моста</a></th>
            <th><a href="?order_by=drive_axle_number">№ ведущего моста</a></th>
            <th><a href="?order_by=steerable_axle_model">модель управляемого моста</a></th>
            <th><a href="?order_by=steerable_axle_number">№ управляемого моста</a></th>
            <th><a href="?order_by=supply_contract">договор поставки №, дата.</a></th>
            <th><a href="?order_by=date_of_shipment_from_the_factory">Дата отгрузки с завода</a></th>
            <th><a href="?order_by=consignee">Грузополучатель</a></th>
            <th><a href="?order_by=delivery_address">Адрес поставки (эксплуатации)</a></th>
            <th><a href="?order_by=equipment">Комплектация (доп. опции)</a></th>
            <th><a href="?order_by=client">Клиент</a></th>
            <th><a href="?order_by=service_company">Сервисная организация</a></th>
        </tr>
        {% for car in cars %}
            <tr class="table_tr" >
                <td><a href="/info/{{ car.id }}">{{ car.factory_number }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.technique_model }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.engine_model }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.engine_number }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.transmission_model }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.transmission_number }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.drive_axle_model }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.drive_axle_number }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.steerable_axle_model }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.steerable_axle_number }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.supply_contract }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.date_of_shipment_from_the_factory|date:"d.m.Y" }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.consignee }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.delivery_address }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.equipment }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.client }}</a></td>
                <td><a href="/info/{{ car.id }}">{{ car.service_company }}</a></td>
            </tr>
        {% endfor %}
        </table>
<br>
        <div id="car_table"></div>

    {% else %}
        <h4 class="center">Нет записей о машинах, которые вам доступны к просмотру.</h4>

        {% if request.user|has_group:"manager" or request.user|has_group:"admin" %}
            <div class="center">
                <a class="button slim" href="{% url 'create_car' %}" role="button">Добавить первую запись о машине</a>
                <a class="button slim" href="{% url 'reference_book' %}" role="button">Редактор справочников</a>
            </div>
        {% endif %}

    {% endif %}
{% endblock content %}